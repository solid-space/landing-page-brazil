import{S as w,b as A,a as R,m as y,p as S,q as b,k as u,u as $,f as k,z as B,a7 as H,ab as Q,h as G,j as h,g as _,O as N,a5 as J,N as K,C as F,c as L,D as I,d as X,E as O,Q as Y,F as D,w as Z,x as W,y as ee}from"./index.03b5aaf0.js";import{M as q,x as te,p as ne,N as ie,o as ae}from"./index.36a91d4c.js";import{n as se}from"./index.bd6c5768.js";import{I as re}from"./index.38950c17.js";import{B as oe}from"./index.b73d347c.js";import{g as le,r as E}from"./utils.a61f0d73.js";import{U as ce}from"./UserAuthenticatedSession.generated.7a0af0ae.js";import{o as de,a as ue,m as me}from"./messages.92bcc9ee.js";import{O as pe}from"./currencies.bbaf1c4b.js";import{o as g}from"./index.60ecfdbb.js";import{T as fe}from"./index.ec1f5bcc.js";const ke={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"OauthSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"provider"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OauthProviderEnum"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sessionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oauth"},arguments:[{kind:"Argument",name:{kind:"Name",value:"provider"},value:{kind:"Variable",name:{kind:"Name",value:"provider"}}},{kind:"Argument",name:{kind:"Name",value:"sessionName"},value:{kind:"Variable",name:{kind:"Name",value:"sessionName"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OauthRequest"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OauthRegister"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"identityId"}},{kind:"Field",name:{kind:"Name",value:"requestEmail"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserAuthenticatedSession"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"UserAuthenticatedSession"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OauthUserExists"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OauthTfa"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"loginToken"}}]}}]}}]}}]}},...ce.definitions]},he=Object.keys(pe).filter(r=>!0);function C(r,t,e){const i=r.slice();return i[13]=t[e],i}function _e(r){let t,e;return t=new re({props:{icon:r[13]}}),{c(){F(t.$$.fragment)},l(i){I(t.$$.fragment,i)},m(i,s){O(t,i,s),e=!0},p(i,s){const o={};s&1&&(o.icon=i[13]),t.$set(o)},i(i){e||(h(t.$$.fragment,i),e=!0)},o(i){_(t.$$.fragment,i),e=!1},d(i){D(t,i)}}}function V(r,t){let e,i,s,o;function c(){return t[6](t[13])}return i=new oe({props:{iconOnly:!0,size:"sm",type:"button",disabled:t[2],variant:"neutral","data-analytics":"provider-login-"+t[13],fullWidth:!0,$$slots:{default:[_e]},$$scope:{ctx:t}}}),i.$on("click",c),{key:r,first:null,c(){e=y("div"),F(i.$$.fragment),s=L(),this.h()},l(n){e=S(n,"DIV",{class:!0});var a=b(e);I(i.$$.fragment,a),s=X(a),a.forEach(u),this.h()},h(){$(e,"class","provider-wrapper"),this.first=e},m(n,a){k(n,e,a),O(i,e,null),Y(e,s),o=!0},p(n,a){t=n;const l={};a&4&&(l.disabled=t[2]),a&1&&(l["data-analytics"]="provider-login-"+t[13]),a&65537&&(l.$$scope={dirty:a,ctx:t}),i.$set(l)},i(n){o||(h(i.$$.fragment,n),o=!0)},o(n){_(i.$$.fragment,n),o=!1},d(n){n&&u(e),D(i)}}}function ve(r){let t,e=[],i=new Map,s,o=r[0];const c=n=>n[13];for(let n=0;n<o.length;n+=1){let a=C(r,o,n),l=c(a);i.set(l,e[n]=V(l,a))}return{c(){t=y("div");for(let n=0;n<e.length;n+=1)e[n].c();this.h()},l(n){t=S(n,"DIV",{class:!0});var a=b(t);for(let l=0;l<e.length;l+=1)e[l].l(a);a.forEach(u),this.h()},h(){$(t,"class","oauth svelte-1o26lbx")},m(n,a){k(n,t,a);for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(t,null);s=!0},p(n,[a]){a&7&&(o=n[0],B(),e=H(e,a,c,1,n,o,i,t,Q,V,null,C),G())},i(n){if(!s){for(let a=0;a<o.length;a+=1)h(e[a]);s=!0}},o(n){for(let a=0;a<e.length;a+=1)_(e[a]);s=!1},d(n){n&&u(t);for(let a=0;a<e.length;a+=1)e[a].d()}}}function ge(r,t,e){let i,s;N(r,q,d=>e(8,i=d)),N(r,g,d=>e(9,s=d));let{providers:o=he}=t,c,n,a,l,v=!1;const x=J(),T=()=>{e(1,c=void 0),e(3,n=void 0),e(4,a=void 0)};let m;K(()=>{m&&clearInterval(m),n&&n.close(),(s==null?void 0:s.type)==="oauth"&&(s==null||s.unsubscribe(),g.set(null))});const P=async d=>{e(2,v=!0);const M=ae();l=ne(M.subscription(ke,{provider:d,sessionName:le()}),ie(async({data:j,error:z})=>{e(4,a=await de({data:j,error:z,provider:d,eventDispatcher:x,handlers:{OauthRequest:p=>{if((p==null?void 0:p.__typename)!=="OauthRequest")return;const f=ue({url:`https://${p.url}`,windowName:`Connect OAuth with ${d}`});!f||f.closed||typeof f.closed>"u"?(se.error.open({message:i._(me.popupWindowError)}),T()):e(3,n=f)}}})),e(2,v=!1)})),g.openSubscription("oauth",l.unsubscribe)},U=d=>{e(1,c=d)};return r.$$set=d=>{"providers"in d&&e(0,o=d.providers)},r.$$.update=()=>{r.$$.dirty&56&&n&&(clearInterval(m),e(5,m=setInterval(()=>{a&&!(n!=null&&n.closed)&&(n==null||n.close()),n!=null&&n.closed&&(clearInterval(m),a||T())},100))),r.$$.dirty&2&&c&&te&&P(c)},[o,c,v,n,a,m,U]}class Ae extends w{constructor(t){super(),A(this,t,ge,ve,R,{providers:0})}}function Ne(r){let t=r[0]._(E.or)+"",e;return{c(){e=Z(t)},l(i){e=W(i,t)},m(i,s){k(i,e,s)},p(i,s){s&1&&t!==(t=i[0]._(E.or)+"")&&ee(e,t)},d(i){i&&u(e)}}}function ye(r){let t,e,i;return e=new fe({props:{align:"center",$$slots:{default:[Ne]},$$scope:{ctx:r}}}),{c(){t=y("div"),F(e.$$.fragment),this.h()},l(s){t=S(s,"DIV",{class:!0});var o=b(t);I(e.$$.fragment,o),o.forEach(u),this.h()},h(){$(t,"class","or svelte-tnee6d")},m(s,o){k(s,t,o),O(e,t,null),i=!0},p(s,[o]){const c={};o&3&&(c.$$scope={dirty:o,ctx:s}),e.$set(c)},i(s){i||(h(e.$$.fragment,s),i=!0)},o(s){_(e.$$.fragment,s),i=!1},d(s){s&&u(t),D(e)}}}function Se(r,t,e){let i;return N(r,q,s=>e(0,i=s)),[i]}class Re extends w{constructor(t){super(),A(this,t,Se,ye,R,{})}}export{Re as O,Ae as R};
