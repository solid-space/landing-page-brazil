import{S as B,b as C,a as $,C as b,D as h,E as F,j as I,g as k,F as w,O as D,n as A}from"./index.03b5aaf0.js";import{o as U}from"./index.36a91d4c.js";import{S as j,U as q}from"./UpdateSportsFavourites.generated.eb18df09.js";import{B as E}from"./index.b73d347c.js";import{I as M}from"./index.38950c17.js";import"./lodash.9552c526.js";import{m as O}from"./makeFetchStore.b02896aa.js";function P(r){let t,i;return t=new M({props:{icon:r[2]?"favourited":"favourite"}}),{c(){b(t.$$.fragment)},l(a){h(t.$$.fragment,a)},m(a,e){F(t,a,e),i=!0},p(a,e){const d={};e&4&&(d.icon=a[2]?"favourited":"favourite"),t.$set(d)},i(a){i||(I(t.$$.fragment,a),i=!0)},o(a){k(t.$$.fragment,a),i=!1},d(a){w(t,a)}}}function z(r){var a,e,d;let t,i;return t=new E({props:{variant:"neutral",noShadow:!0,disabled:!((e=(a=r[1])==null?void 0:a.data)!=null&&e.user),loading:((d=r[1])==null?void 0:d.loading)||r[0],$$slots:{default:[P]},$$scope:{ctx:r}}}),t.$on("click",r[5]),{c(){b(t.$$.fragment)},l(n){h(t.$$.fragment,n)},m(n,o){F(t,n,o),i=!0},p(n,[o]){var f,s,c;const l={};o&2&&(l.disabled=!((s=(f=n[1])==null?void 0:f.data)!=null&&s.user)),o&3&&(l.loading=((c=n[1])==null?void 0:c.loading)||n[0]),o&68&&(l.$$scope={dirty:o,ctx:n}),t.$set(l)},i(n){i||(I(t.$$.fragment,n),i=!0)},o(n){k(t.$$.fragment,n),i=!1},d(n){w(t,n)}}}const _=(()=>O(j))();function G(r,t,i){let a,e,d=A;D(r,_,s=>i(1,e=s)),r.$$.on_destroy.push(()=>d());let{loading:n=!1}=t,{sport:o}=t;const l=async()=>{var s;if(o&&((s=e==null?void 0:e.data)!=null&&s.user)){let c=o==null?void 0:o.id,m=U(),p=(e==null?void 0:e.data.user.preference.sportsFavourites.includes(c))?e==null?void 0:e.data.user.preference.sportsFavourites.filter(u=>u!==c):[...(e==null?void 0:e.data.user.preference.sportsFavourites)||[],c],y=m.mutation(q,{preference:{sportsFavourites:p}});_.update(u=>{var g;return{...u,data:(g=u==null?void 0:u.data)!=null&&g.user?{...u.data,user:{...u.data.user,preference:{...u.data.user.preference,sportsFavourites:p}}}:u==null?void 0:u.data}}),await y.toPromise()}},f=()=>l();return r.$$set=s=>{"loading"in s&&i(0,n=s.loading),"sport"in s&&i(4,o=s.sport)},r.$$.update=()=>{var s,c,m;r.$$.dirty&18&&i(2,a=o&&((m=(c=(s=e==null?void 0:e.data)==null?void 0:s.user)==null?void 0:c.preference)==null?void 0:m.sportsFavourites.includes(o.id)))},[n,e,a,l,o,f]}class T extends B{constructor(t){super(),C(this,t,G,z,$,{loading:0,sport:4})}}export{T as F,_ as s};
