import{S as D,b as E,a as A,e as v,f as N,z as q,g as k,h as M,j as b,k as g,O as H,a5 as V,C as I,D as P,E as O,F,H as j,I as J,J as K,K as Q,m as G,w as L,p as U,q as W,x as X,Q as Y,n as T,c as ne,d as te,y as ie,o as oe,N as le}from"./index.03b5aaf0.js";import{M as Z,p as se,N as re,o as ae}from"./index.36a91d4c.js";import{m as p,a as ue}from"./messages.92bcc9ee.js";import{n as y}from"./index.bd6c5768.js";import{I as fe}from"./index.38950c17.js";import{B as ce}from"./index.b73d347c.js";import{e as B}from"./index.922d4a37.js";const de={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"oauthConfirm"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oauthConfirm"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"provider"}},{kind:"Field",name:{kind:"Name",value:"result"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OauthRequest"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OauthConfirm"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]}}]}}]};function me(o){let n,i;return n=new ce({props:{type:"button",key:o[0],disabled:o[3]||!!o[2]||o[4]||!o[0],variant:"action",fullWidth:!0,size:o[1],loading:o[3],$$slots:{default:[be]},$$scope:{ctx:o}}}),n.$on("click",o[9]),{c(){I(n.$$.fragment)},l(e){P(n.$$.fragment,e)},m(e,t){O(n,e,t),i=!0},p(e,t){const s={};t&1&&(s.key=e[0]),t&29&&(s.disabled=e[3]||!!e[2]||e[4]||!e[0]),t&2&&(s.size=e[1]),t&8&&(s.loading=e[3]),t&1121&&(s.$$scope={dirty:t,ctx:e}),n.$set(s)},i(e){i||(b(n.$$.fragment,e),i=!0)},o(e){k(n.$$.fragment,e),i=!1},d(e){F(n,e)}}}function _e(o){let n;const i=o[8].default,e=j(i,o,o[10],null);return{c(){e&&e.c()},l(t){e&&e.l(t)},m(t,s){e&&e.m(t,s),n=!0},p(t,s){e&&e.p&&(!n||s&1024)&&J(e,i,t,t[10],n?Q(i,t[10],s,null):K(t[10]),null)},i(t){n||(b(e,t),n=!0)},o(t){k(e,t),n=!1},d(t){e&&e.d(t)}}}function pe(o){let n,i;return{c(){n=G("span"),i=L(" ")},l(e){n=U(e,"SPAN",{});var t=W(n);i=X(t," "),t.forEach(g)},m(e,t){N(e,n,t),Y(n,i)},p:T,i:T,o:T,d(e){e&&g(n)}}}function ke(o){let n,i,e,t=o[5]._(p.buttonText({provider:o[5]._(p[o[0]]),buttonText:o[6]||o[5]._(p.defaultButtonText)}))+"",s,a;return n=new fe({props:{icon:o[0]}}),{c(){I(n.$$.fragment),i=ne(),e=G("span"),s=L(t)},l(r){P(n.$$.fragment,r),i=te(r),e=U(r,"SPAN",{});var l=W(e);s=X(l,t),l.forEach(g)},m(r,l){O(n,r,l),N(r,i,l),N(r,e,l),Y(e,s),a=!0},p(r,l){const u={};l&1&&(u.icon=r[0]),n.$set(u),(!a||l&97)&&t!==(t=r[5]._(p.buttonText({provider:r[5]._(p[r[0]]),buttonText:r[6]||r[5]._(p.defaultButtonText)}))+"")&&ie(s,t)},i(r){a||(b(n.$$.fragment,r),a=!0)},o(r){k(n.$$.fragment,r),a=!1},d(r){F(n,r),r&&g(i),r&&g(e)}}}function be(o){let n,i,e,t;const s=[ke,pe],a=[];function r(l,u){return l[0]?0:1}return n=r(o),i=a[n]=s[n](o),{c(){i.c(),e=v()},l(l){i.l(l),e=v()},m(l,u){a[n].m(l,u),N(l,e,u),t=!0},p(l,u){let d=n;n=r(l),n===d?a[n].p(l,u):(q(),k(a[d],1,1,()=>{a[d]=null}),M(),i=a[n],i?i.p(l,u):(i=a[n]=s[n](l),i.c()),b(i,1),i.m(e.parentNode,e))},i(l){t||(b(i),t=!0)},o(l){k(i),t=!1},d(l){a[n].d(l),l&&g(e)}}}function he(o){let n,i,e,t;const s=[_e,me],a=[];function r(l,u){return l[2]?0:1}return n=r(o),i=a[n]=s[n](o),{c(){i.c(),e=v()},l(l){i.l(l),e=v()},m(l,u){a[n].m(l,u),N(l,e,u),t=!0},p(l,[u]){let d=n;n=r(l),n===d?a[n].p(l,u):(q(),k(a[d],1,1,()=>{a[d]=null}),M(),i=a[n],i?i.p(l,u):(i=a[n]=s[n](l),i.c()),b(i,1),i.m(e.parentNode,e))},i(l){t||(b(i),t=!0)},o(l){k(i),t=!1},d(l){a[n].d(l),l&&g(e)}}}function ge(o,n,i){let e,t;H(o,Z,c=>i(5,t=c));let{$$slots:s={},$$scope:a}=n,{selectedProvider:r}=n,{size:l="xl"}=n,{token:u}=n,{loading:d}=n,{disabled:_}=n;const m=V(),S=()=>m("click");return o.$$set=c=>{"selectedProvider"in c&&i(0,r=c.selectedProvider),"size"in c&&i(1,l=c.size),"token"in c&&i(2,u=c.token),"loading"in c&&i(3,d=c.loading),"disabled"in c&&i(4,_=c.disabled),"$$scope"in c&&i(10,a=c.$$scope)},o.$$.update=()=>{o.$$.dirty&36&&i(6,e=u?t._(p.verifiedButtonText):t._(p.reVerifyButtonText))},[r,l,u,d,_,t,e,m,s,S,a]}class Se extends D{constructor(n){super(),E(this,n,ge,he,A,{selectedProvider:0,size:1,token:2,loading:3,disabled:4})}}function Ne(o){let n;const i=o[9].default,e=j(i,o,o[11],null);return{c(){e&&e.c()},l(t){e&&e.l(t)},m(t,s){e&&e.m(t,s),n=!0},p(t,s){e&&e.p&&(!n||s&2048)&&J(e,i,t,t[11],n?Q(i,t[11],s,null):K(t[11]),null)},i(t){n||(b(e,t),n=!0)},o(t){k(e,t),n=!1},d(t){e&&e.d(t)}}}function ve(o){let n,i;return n=new Se({props:{token:o[2],loading:o[4],selectedProvider:o[5],size:o[1],disabled:o[0]||B,$$slots:{default:[Ne]},$$scope:{ctx:o}}}),n.$on("click",o[10]),{c(){I(n.$$.fragment)},l(e){P(n.$$.fragment,e)},m(e,t){O(n,e,t),i=!0},p(e,[t]){const s={};t&4&&(s.token=e[2]),t&16&&(s.loading=e[4]),t&32&&(s.selectedProvider=e[5]),t&2&&(s.size=e[1]),t&1&&(s.disabled=e[0]||B),t&2048&&(s.$$scope={dirty:t,ctx:e}),n.$set(s)},i(e){i||(b(n.$$.fragment,e),i=!0)},o(e){k(n.$$.fragment,e),i=!1},d(e){F(n,e)}}}function Ce(o,n,i){let e;H(o,Z,f=>i(7,e=f));let{$$slots:t={},$$scope:s}=n,{disabled:a}=n,{size:r="xl"}=n,l=!1,u,d,_,m;const S=()=>{i(6,d=void 0),i(2,_=void 0),i(3,m=void 0)},c=()=>{if(m){const f=setInterval(()=>{_&&(m==null||m.close()),m!=null&&m.closed&&(clearInterval(f),_||S())},100);le(()=>clearInterval(f))}};oe(()=>{{i(4,l=!0);const f=ae(),ee=se(f.subscription(de),re(({data:C,error:R})=>{R&&y.error.open({message:R.message});const z=C==null?void 0:C.oauthConfirm;if(z){const{result:h}=z,w=z.provider;u===void 0&&w&&i(5,u=w),(h==null?void 0:h.__typename)==="OauthRequest"&&i(6,d=h.url),(h==null?void 0:h.__typename)==="OauthConfirm"&&(i(2,_=h.token),y.oauthReverified.open())}i(4,l=!1)}));return()=>{ee.unsubscribe()}}});const $=V(),x=()=>{const f=ue({url:`https://${d}`,windowName:`Connect OAuth with ${u}`});!f||f.closed||typeof f.closed>"u"?(y.error.open({message:e._(p.popupWindowError)}),S()):i(3,m=f)};return o.$$set=f=>{"disabled"in f&&i(0,a=f.disabled),"size"in f&&i(1,r=f.size),"$$scope"in f&&i(11,s=f.$$scope)},o.$$.update=()=>{o.$$.dirty&12&&(m||_)&&c(),o.$$.dirty&4&&_&&$("change",_)},[a,r,_,m,l,u,d,e,S,t,x,s]}class Re extends D{constructor(n){super(),E(this,n,Ce,ve,A,{disabled:0,size:1})}}export{Re as R};
