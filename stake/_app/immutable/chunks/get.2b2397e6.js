import{x as y}from"./index.36a91d4c.js";import{H as A}from"./index.d274af24.js";import{D as S}from"./index.922d4a37.js";import{g as $}from"./loadHelpers.abbaab45.js";const d="tdrhge4k",E=S,O="v2023-03-26",T=`https://${d}.apicdn.sanity.io/${O}/data/query/${E}`,j=({query:c,params:l={},options:h={}})=>{const t=new URLSearchParams,{tag:o,...n}=h;o&&t.set("tag",o),t.set("query",c);for(const[e,s]of Object.entries(l))t.set(`$${e}`,JSON.stringify(s));for(const[e,s]of Object.entries(n))s&&t.set(e,`${s}`);return`?${t.toString()}`},p=new Map;function R(c){const l=Array(c).join("");return async function(t,o){let n=null;const s=new AbortController().signal;try{const u=await $(t),w=j({query:l,params:{lang:u.locale??"en",...o}}),a=`${T}${w}`,g=Date.now();if(y&&p.has(a)){const f=p.get(a);if(f&&f.invalidateAt>g)return f.result}const r=await t.fetch(a,{method:"GET",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},signal:s}),i=await r.json();if("error"in i)throw console.error("sanity: error",i),Error("sanity: error found in json");if(r.status!==200)throw console.log("sanity: response status is ",r.status),Error("sanity: response status is "+r.status);if(!("result"in i))throw console.log("sanity: response is empty",r.status),Error("sanity: no result json in");const m=i.result;return y&&p.set(a,{result:m,invalidateAt:g+A}),m}catch(u){return console.error("sanity fetch error",u),null}finally{n&&clearTimeout(n)}}}export{R as c};
